@media (prefers-color-scheme:dark) {
   :root {
      --bg: #1a1b26;

      --urlbar-bg: #0d0d15;
      --urlbar-border-top: #000;
      --urldrop-bg: #0d0d15;
      --urlbar-border-bottom: #404040;
      --urlbar-height: 30px;
      --urlbar-outline: #414868;

      /* 柔和的文字颜色 */
      --urlbar-text-color: #a9b1d6;
      --urlbar-placeholder-color: #565f89;
      --urlbar-suggestion-text: #c0caf5;

      --fullscreen-warn: rgb(25, 25, 25);

      --arrowpanel-background: var(--urlbar-bg) !important;
      --button-hover-bgcolor: rgba(159, 159, 159, 0.35) !important;
      --button-active-bgcolor: rgba(255, 255, 255, .2) !important;
      --button-bgcolor: rgba(117, 117, 117, 0.9) !important;
      --toolbarbutton-icon-fill-opacity: 0.8 !important;
      --arrowpanel-border-color: rgb(55, 55, 55) !important;
      --identity-btn-hover-color: rgba(117, 117, 117) !important;

      --dark-menu-background-color: rgba(34, 34, 36, .5) !important;
      --dark-menu-border-color: rgb(55, 55, 55) !important;
      --dark-menuitem-hover-background-color: rgba(159, 159, 159, 0.35) !important;
   }
}

@media (prefers-color-scheme:light) {
   :root {
      --bg: #f1f5f9;

      --urlbar-bg: #e1e8ef;
      --urlbar-border-top: #9ca3af;
      --urlbar-border-bottom: #fff;
      --urldrop-bg: #e1e8ef;
      --urlbar-outline: #94a3b8;

      /* 柔和的文字颜色 - 浅色主题 */
      --urlbar-text-color: #475569;
      --urlbar-placeholder-color: #94a3b8;
      --urlbar-suggestion-text: #334155;

      --fullscreen-warn: rgb(25, 25, 25);

      --arrowpanel-background: #e2e8f0 !important;
      --button-hover-bgcolor: #e1e8ef !important;
      --button-active-bgcolor: #e1e8ef !important;
      --identity-btn-hover-color: white !important;
   }
}

/* (可选隐藏状态面板的代码已移除，如需可自行恢复) */

/* URL BAR */
#urlbar {
   border-radius: 30px !important;
   border: 0 !important;
}

/* 强制搜索栏文字颜色优化 - 使用更具体的选择器 */
#urlbar #urlbar-input,
#urlbar-input,
.urlbar-input {
   color: #a9b1d6 !important;
   font-weight: 400 !important;
   text-shadow: none !important;
}

/* 强制占位符文字颜色 */
#urlbar #urlbar-input::placeholder,
#urlbar-input::placeholder,
.urlbar-input::placeholder {
   color: #565f89 !important;
   opacity: 0.8 !important;
}

/* 强制搜索建议文字颜色 */
.urlbarView-row,
.urlbarView-row * {
   color: #c0caf5 !important;
}

.urlbarView-row[selected],
.urlbarView-row[selected] * {
   color: #a9b1d6 !important;
}

/* 强制 URL 文字颜色 */
.urlbarView-url,
.urlbarView-url * {
   color: #565f89 !important;
   opacity: 0.9 !important;
}

/* 强制搜索建议标题 */
.urlbarView-title,
.urlbarView-title * {
   color: #a9b1d6 !important;
   font-weight: 400 !important;
}

/* 强制所有 urlbar 内的文字 */
#urlbar *,
#urlbar-input-container *,
.urlbar-input-container * {
   color: #a9b1d6 !important;
}

/* 针对浅色主题的强制样式 */
@media (prefers-color-scheme: light) {

   #urlbar #urlbar-input,
   #urlbar-input,
   .urlbar-input {
      color: #475569 !important;
   }

   #urlbar #urlbar-input::placeholder,
   #urlbar-input::placeholder,
   .urlbar-input::placeholder {
      color: #94a3b8 !important;
   }

   #urlbar *,
   #urlbar-input-container *,
   .urlbar-input-container * {
      color: #475569 !important;
   }
}

#urlbar:not(.megabar):hover {
   outline: 1px solid var(--urlbar-outline) !important;
}

#urlbar[focused="true"] {
   border: 0 !important;
   border-top: 1px solid var(--urlbar-border-top) !important;
   border-bottom: 1px solid var(--urlbar-border-bottom) !important;
   border-radius: 30px !important;
}

#urlbar[breakout][breakout-extend] {
   border: none !important;
   box-shadow: rgba(0, 0, 0, 0.09) 0px 2px 1px, rgba(0, 0, 0, 0.09) 0px 4px 2px,
      rgba(0, 0, 0, 0.09) 0px 8px 4px, rgba(0, 0, 0, 0.09) 0px 16px 8px,
      rgba(0, 0, 0, 0.09) 0px 32px 16px !important;
   top: calc((var(--urlbar-toolbar-height) - var(--urlbar-height)) / 2) !important;
   /* left: 0 !important; */
   /* width: 100% !important; */
   /* removed invalid width: calc(--urlbar-width) */
}

#urlbar-container {
   margin-top: 3px;
   display: initial;
}

#urlbar-background {
   box-shadow: none !important;
   border-radius: 30px !important;
   background: var(--urlbar-bg) !important;
}

#urlbar[focused="true"] #urlbar-background {
   box-shadow: inset 1px 1px 1px 0px rgba(0, 0, 0, 0.35) !important;
   outline: none !important;
}

#wrapper-urlbar-container #urlbar {
   height: var(--urlbar-height) !important;
}

/* Active Address/Search Field Dropdown */
#urlbar[breakout][breakout-extend]>#urlbar-background {
   outline: none !important;
   box-shadow: none !important;
   background: var(--urldrop-bg) !important;
   border-radius: 15px !important;
}

#urlbar[breakout][breakout-extend]>#urlbar-input-container,
#urlbar-input-container {
   height: var(--urlbar-height) !important;
   padding-block: 0px !important;
   padding-inline: 0px !important;
   transition: none !important;
}

/* Idendity icon button */
#identity-icon-box.identity-box-button {
   margin: 3px 0 3px 3px;
   border-radius: 14px !important;
   background-color: var(--bg) !important;
   opacity: 0.8
}

#identity-icon-box.identity-box-button:hover {
   cursor: pointer;
   background-color: var(--identity-btn-hover-color) !important;
}

/* Track protection icon */
#tracking-protection-icon-container {
   border-radius: 16px !important;
}

#tracking-protection-icon-container:hover {
   cursor: pointer !important;
}

/* Star button */
#star-button-box {
   border-radius: 16px !important;
}

#star-button-box {
   cursor: pointer !important;
}

/* | Borders | */

.tabbrowser-tab::after {
   border: 0 !important;
}

.titlebar-spacer[type="pre-tabs"] {
   border: 0 !important;
}

#navigator-toolbox {
   border: 1 !important;
}

.titlebar-spacer[type="pre-tabs"] {
   border: 0 !important;
}

.tabbrowser-tab::after {
   border: 0 !important;
}

#urlbar-background {
   border: 0 !important;
}

#urlbar[open]>.urlbarView>.urlbarView-body-outer>.urlbarView-body-inner {
   border-top: 0 !important;
}


/* Active Tab */
:root:not([lwt-default-theme-in-dark-mode]) .tab-background[selected],
.tab-background[multiselected="true"] {
   background: rgba(0, 0, 0, .05) !important;
}

:root[lwt-default-theme-in-dark-mode] .tab-background[selected],
.tab-background[multiselected="true"] {
   background: rgba(0, 0, 0, .2) !important;
}


/* Navigation Bar */
#nav-bar {
   background-color: var(--bg) !important;
}

/* Bookmarks Bar */
#PersonalToolbar {
   background-color: var(--bg) !important;
}

/* Navigation Bar Separator */
#navigator-toolbox {
   border-color: var(--bg) !important;
}

/* Navigation bar Buttons */
toolbarbutton:hover {
   cursor: pointer;
}

/* Show Tab close button on hover */
.tabbrowser-tab:not([pinned]) .tab-close-button {
   display: -moz-box !important;
   opacity: 0;
   visibility: collapse !important;
   transition: opacity 0.25s, visibility 0.25s ease-in !important;
}

.tabbrowser-tab:not([pinned]):hover .tab-close-button {
   opacity: 1;
   visibility: visible !important;
   border-radius: 3px 3px 3px 3px !important;
}

/* Show URL buttons on Hover */
#nav-bar:not([customizing="true"])>#nav-bar-customization-target>#urlbar-container:not(:hover)>#urlbar:not([focused])>#urlbar-input-container>#page-action-buttons {
   opacity: 0;
}

#page-action-buttons {
   transition: opacity 0.15s ease;
}

#nav-bar:not([customizing="true"])>#nav-bar-customization-target>#urlbar-container:not(:hover)>#urlbar:not([focused])>#urlbar-input-container>#tracking-protection-icon-container {
   opacity: 0;
}

#tracking-protection-icon-container {
   transition: opacity 0.15s ease;
}


/*Full Screen Warning*/

#fullscreen-warning {
   background-color: var(--fullscreen-warn) !important;
   border-color: var(--fullscreen-warn) !important;
   max-width: 500px !important;
   max-height: 50px !important;
   border-radius: 50px !important;
   font-size: 12px !important;
   opacity: 0.8 !important;
}

.pointerlockfswarning-generic-text,
.pointerlockfswarning-domain-text {
   font-size: 15px !important;
   color: rgb(255, 255, 255) !important;
   text-shadow: none !important;
}


toolbar#TabsToolbar {
   height: 0px;
   min-height: 0 !important;
   background-color: var(--bg) !important;
   visibility: collapse !important;
}

.toolbar-items {
   visibility: collapse;
}

/* Fix title bar background */
#titlebar {
   background-color: var(--bg) !important;
}

/* Ensure no white space at top */
#main-window {
   background-color: var(--bg) !important;
}

/* Fix window controls area */
.titlebar-buttonbox-container {
   background-color: var(--bg) !important;
}

/* 菜单按钮顺序调整 */

#nav-bar #PanelUI-button {
   -moz-box-ordinal-group: 0 !important;
}

#nav-bar #PanelUI-button #PanelUI-menu-button {
   margin-right: 2px !important;
   margin-left: 2px !important;
}


/* 关闭/最小化/最大化按钮与导航对齐 */
#appMenu-popup {
   margin-inline: -244px !important;
}

#nav-bar {
   padding-left: 0px !important;
   padding-right: 90px !important;
   position: static !important;
}


#TabsToolbar .titlebar-min {
   -moz-box-ordinal-group: 0 !important;
}

#TabsToolbar .titlebar-max,
.titlebar-restore {
   -moz-box-ordinal-group: 1 !important;
}

#TabsToolbar .titlebar-close {
   -moz-box-ordinal-group: 2 !important;
}


@media only screen and (max-width: 670px) {
   #main-window #navigator-toolbox:not([inFullscreen]) #TabsToolbar .titlebar-buttonbox-container {
      visibility: visible !important;
      position: relative !important;
      display: block !important;
   }

   #main-window #navigator-toolbox:not([inFullscreen]) #nav-bar {
      padding-right: initial !important;
   }

   #TabsToolbar.browser-toolbar {
      display: flex !important;
      justify-content: flex-end !important;
   }

}

#toolbar-menubar {
   /* menubar bg color */
   background-color: var(--bg) !important;
}

/* Additional fixes for white space at top */
#navigator-toolbox-background {
   background-color: var(--bg) !important;
}

/* Ensure all toolbars have consistent background */
.browser-toolbar {
   background-color: var(--bg) !important;
}

/* Fix any remaining white space */
#main-window>#navigator-toolbox {
   background-color: var(--bg) !important;
}

/* 进一步优化搜索栏视觉效果 */
#urlbar-input-container {
   color: #a9b1d6 !important;
}

/* 搜索栏图标颜色优化 */
#urlbar .urlbar-icon {
   opacity: 0.7 !important;
   filter: brightness(0.8) !important;
}

/* 下拉建议背景优化 */
.urlbarView {
   background-color: var(--urldrop-bg) !important;
   border-radius: 15px !important;
}

.urlbarView-row:hover {
   background-color: rgba(255, 255, 255, 0.05) !important;
}

/* 减少整体对比度 */
#urlbar-background {
   opacity: 0.95 !important;
}

/* 额外的强制文字颜色修复 */
#urlbar input,
#urlbar input[type="text"],
#urlbar-input[type="text"],
input#urlbar-input {
   color: #a9b1d6 !important;
   -webkit-text-fill-color: #a9b1d6 !important;
}

/* 修复可能的 Firefox 内部样式覆盖 */
#urlbar-input-container input,
#urlbar-input-container .textbox-input,
.urlbar-input-container input {
   color: #a9b1d6 !important;
   -webkit-text-fill-color: #a9b1d6 !important;
}

/* 浅色主题的额外修复 */
@media (prefers-color-scheme: light) {

   #urlbar input,
   #urlbar input[type="text"],
   #urlbar-input[type="text"],
   input#urlbar-input,
   #urlbar-input-container input,
   #urlbar-input-container .textbox-input,
   .urlbar-input-container input {
      color: #475569 !important;
      -webkit-text-fill-color: #475569 !important;
   }
}


/* Line up the Windows controls with the rest of the icons in the toolbar. */
:root:not([sizemode="maximized"]) .titlebar-buttonbox-container {
   padding-top: 3px;
}

.titlebar-buttonbox {
   z-index: 3 !important;
   padding-right: 8px;
   padding-top: 8px;
}

/* SIDEBERY */
#sidebar-header {
   display: none !important;
}

.tab[selected="true"] {
   visibility: collapse;
   height: 0px;
}

.tabbrowser-tab {
   visibility: collapse;
   height: 0px;
}

.tabbrowser-tab[visuallyselected="true"] {
   visibility: collapse;
   height: 0px;
}

/* AUTO HIDE SIDE BAR */

#sidebar-box {
   --uc-sidebar-min-width: 40px;
   --uc-sidebar-hover-width: 260px;
   --uc-autohide-sidebar-delay: 1ms;
   /* Waiting time before hiding sidebar */
   position: relative;
   min-width: var(--uc-sidebar-min-width) !important;
   width: var(--uc-sidebar-min-width) !important;
   max-width: var(--uc-sidebar-min-width) !important;
   z-index: 100 !important;
}

#sidebar-box[positionend] {
   direction: rtl;
}

#sidebar-box[positionend]>* {
   direction: ltr;
}

#sidebar-box[positionend]:-moz-locale-dir(rtl) {
   direction: ltr;
}

#sidebar-box[positionend]:-moz-locale-dir(rtl)>* {
   direction: rtl;
}

/* HIDE SIDE BAR IN FULL SCREEN */
#main-window[inFullscreen="true"] #sidebar-box {
   --uc-sidebar-width: 0px;
}

#sidebar-splitter {
   display: none;
}

#sidebar-header {
   overflow: hidden;
   color: var(--bg) !important;
}

#sidebar {
   transition: min-width 115ms linear var(--uc-autohide-sidebar-delay) !important;
   min-width: var(--uc-sidebar-min-width) !important;
   will-change: min-width;
}

#sidebar-box:hover>#sidebar {
   min-width: var(--uc-sidebar-hover-width) !important;
   transition-delay: 0ms !important;
}

/* Expand container on hover to avoid clipping */
#sidebar-box:hover {
   min-width: var(--uc-sidebar-hover-width) !important;
   width: var(--uc-sidebar-hover-width) !important;
   max-width: var(--uc-sidebar-hover-width) !important;
}

.sidebar-panel {
   background-color: transparent !important;
   color: var(--newtab-text-primary-color) !important;
}

.sidebar-panel #search-box {
   -moz-appearance: none !important;
   background-color: rgba(249, 249, 250, 0.1) !important;
   color: inherit !important;
}

/* sidebar divider */

#sidebar,
#sidebar-header {
   background-color: inherit !important;
   /* 	border-inline: 1px solid rgb(80, 80, 80); */
   border-inline-width: 0px 1px;
}

/* Sidebery specific: add toolbar background and divider */
#sidebar-box[sidebarcommand="_3c078156-979c-498b-8990-85f7987dd929_-sidebar-action"]>#sidebar,
#sidebar-box[sidebarcommand="_3c078156-979c-498b-8990-85f7987dd929_-sidebar-action"]>#sidebar-header {
   background-color: var(--toolbar-bgcolor) !important;
   border-inline: 1px solid var(--chrome-content-separator-color) !important;
   border-inline-width: 0px 1px;
}

#sidebar-box:not([positionend])> :-moz-locale-dir(rtl),
#sidebar-box[positionend]>* {
   border-inline-width: 1px 0px;
}

/* 状态面板跟随侧栏 */

#sidebar-box:not([positionend]):hover~#appcontent #statuspanel {
   inset-inline: auto 0px !important;
}

#sidebar-box:not([positionend]):hover~#appcontent #statuspanel-label {
   margin-inline: 0px !important;
   border-left-style: solid !important;
}

/* 移除旧的 titlepreface (🦊) 条件布局，避免高度/按钮尺寸混乱 */

/* 防止潜在的第二套系统按钮显示：强制隐藏非我们定位的容器副本 */
#titlebar > .titlebar-buttonbox-container:not(#navigator-toolbox .titlebar-buttonbox-container) {
  display: none !important;
}

:root {
   --wc-height: 24px;          /* 原 20 -> 24，更好覆盖原生按钮 */
   --wc-left-margin: 10px;
   --wc-btn-padding-top: 4px;  /* 容器内顶部补偿，保证垂直居中 */
   --wc-gap: 10px;             /* 按钮间距，避免重叠 */
   --wc-red: hsl(-10, 90%, 60%);
   --wc-yellow: hsl(50, 90%, 60%);
   --wc-green: hsl(160, 90%, 40%);
}

#titlebar {
   appearance: none !important;
}

.titlebar-button>.toolbarbutton-icon {
   visibility: hidden !important;
   display: none !important;
}

.titlebar-button {
   padding: 0 !important;
   height: var(--wc-height) !important;
   min-height: var(--wc-height) !important;
   width: var(--wc-height) !important;
   min-width: var(--wc-height) !important;
   border-radius: 50% !important;
   opacity: 0.82 !important;
   border: none !important;
   -moz-appearance: none !important;
   appearance: none !important;
   box-shadow: 0 0 0 1px rgba(0,0,0,.35), 0 1px 2px rgba(0,0,0,.35);
   backdrop-filter: saturate(1.2);
}

.titlebar-button:hover {
   transform: scale(1.08);
   opacity: 1 !important;
   cursor: pointer;
   box-shadow: 0 0 0 1px rgba(0,0,0,.55), 0 2px 4px rgba(0,0,0,.5);
}

.titlebar-buttonbox {
   display: flex !important;
   margin-right: 8px;
   align-items: center;
   padding-top: var(--wc-btn-padding-top);
}
/* 使用 margin 控制间隔，兼容 gap 可能失效的情况 */
.titlebar-buttonbox .titlebar-button { margin-left: var(--wc-gap) !important; }
.titlebar-buttonbox .titlebar-button:first-child { margin-left: 0 !important; }

.titlebar-close {
   background: var(--wc-red) !important;
}

.titlebar-min {
   background: var(--wc-yellow) !important;
}

.titlebar-max,
.titlebar-restore {
   background: var(--wc-green) !important;
}

/* 顶部拖拽条与侧边拖拽条相关注释已移除（当前仅使用中间横向拖拽空白）。 */

/* 中间横向拖拽空白 (地址栏右侧) */
:root {
   --drag-gap-width: 140px;  /* 你想要的空白宽度：80~200 之间自行调整 */
}

/* 横向拖拽配置 */
:root { --inline-drag-gap-width: 120px; }

/* 关闭旧的扩展按钮伪元素方案 */
#unified-extensions-button { margin-left: 0 !important; }
#unified-extensions-button::before { display: none !important; }

/* 可选：no-top-drag 类 */
:root.no-top-drag #navigator-toolbox::before { display: none !important; }

/* 横向拖拽区域 */
#urlbar-container {
   position: relative;
   /* 给右侧预留可拖拽区域宽度 */
   margin-right: var(--inline-drag-gap-width) !important;
}

/* 伪元素：真实拖拽区 */
#urlbar-container::after {
   content: "";
   position: absolute;
   top: 0; right: calc(-1 * var(--inline-drag-gap-width));
   height: 100%; width: var(--inline-drag-gap-width);
   -moz-window-dragging: drag;
   pointer-events: auto; /* 接收双击 */
   background: transparent;
}

/* 小屏收缩 */
@media (max-width: 1080px) {
   :root { --inline-drag-gap-width: 48px; }
}

/* 调试时可添加虚线轮廓 */
/*
#urlbar-container::after:hover { outline: 1px dashed rgba(255,255,255,.25); }
*/

/* 确保导航栏容器是 flex，便于我们通过 margin 制造间隔 */
#nav-bar-customization-target {
   display: flex;
   align-items: center;
}

/* 兼容备用：隐藏扩展菜单时使用第一个按钮做锚点 */
#unified-extensions-button {
   position: relative !important;
   margin-left: var(--drag-gap-width) !important; /* 腾出空白 */
}

/* 旧方案：扩展按钮左侧伪元素 (保留以防回滚) */
#unified-extensions-button::before {
   content: "";
   position: absolute;
   left: calc(-1 * var(--drag-gap-width));
   top: 0;
   width: var(--drag-gap-width);
   height: 100%;
   -moz-window-dragging: drag;          /* 允许拖拽/双击 */
   pointer-events: auto;                /* 需要事件以接收双击 */
   background: transparent;             /* 保持视觉空白 */
}

/* 可选：当窗口特别窄时自动关闭，避免内容被压缩 */
@media (max-width: 1080px) {
   #unified-extensions-button {
      margin-left: 16px !important;
   }
   #unified-extensions-button::before { display: none; }
}

/* Fallback：如果没有 unified-extensions-button（旧版或被移除），
    可以启用下面的规则，把第一个普通按钮作为锚点。
    取消注释即可：
    #nav-bar-customization-target > #urlbar-container + toolbarbutton {
       position: relative !important;
       margin-left: var(--drag-gap-width) !important;
    }
    #nav-bar-customization-target > #urlbar-container + toolbarbutton::before {
       content:""; position:absolute; left:calc(-1 * var(--drag-gap-width)); top:0;
       width:var(--drag-gap-width); height:100%; -moz-window-dragging:drag; background:transparent;
    }
*/

/* 如果与拖拽顶部条重复，可减小顶部条高度或干脆移除 DRAG STRIP BLOCK。两者可共存。 */

/* ========================================================================
    DISABLE TOP DRAG STRIP & ALIGN WINDOW BUTTONS
    需求: 仅保留地址栏与扩展之间的横向拖拽空白，不要整条顶部拖拽带，
             并让最小化/最大化/关闭按钮与其它图标在同一水平线。
    做法: 覆盖先前为顶部拖拽条加的 padding / 伪元素。
    若想恢复顶部拖拽条：删除本块或注释 #navigator-toolbox 的覆盖规则即可。
    可调: --window-buttons-top-offset 控制按钮垂直微调。
    ======================================================================== */
:root { --window-buttons-top-offset: 2px; }

/* 移除顶部额外留白与伪元素 */
#navigator-toolbox { padding-top: 0 !important; }
#navigator-toolbox::before { display: none !important; }

/* 调整窗口按钮垂直位置（可按需要改数值） */
.titlebar-buttonbox-container {
   top: var(--window-buttons-top-offset) !important;
}

/* 若仍存在 drag-strip 变量引用，强制其高度为 0，避免空洞 */
:root { --drag-strip-height: 0px !important; }

/* =====================================================================
    WINDOW BUTTON CLUSTER ALIGNMENT FIX
    目标: 解决自定义彩色圆形窗口按钮与原生区域未完全重合/看起来挤在一起的问题。
    做法: 重新计算右侧保留宽度, 使用固定定位并为导航栏留出填充。
    可调参数:
         --wc-gap            按钮之间水平间距
         --wc-right-offset   按钮群距离窗口右边缘偏移
         --wc-top-offset     按钮群距离顶部偏移
         --wc-cluster-width  自动计算导航栏需要预留的宽度 (可按需要微调)
    如需再放大按钮: 调整前面定义的 --wc-height。
    ===================================================================== */
:root {
   --wc-gap: 10px;
   --wc-right-offset: 8px;
   --wc-top-offset: 6px;
   --wc-cluster-width: calc(var(--wc-height) * 3 + var(--wc-gap) * 2 + 16px);
}

/* 为导航栏内容右侧预留空间，避免扩展图标被窗口按钮覆盖 */
#nav-bar { padding-right: var(--wc-cluster-width) !important; }

/* 固定窗口按钮容器到右上角 */
#navigator-toolbox:not([inFullscreen]) .titlebar-buttonbox-container {
   position: fixed !important;
   top: var(--wc-top-offset) !important;
   right: var(--wc-right-offset) !important;
   display: flex !important;
   align-items: center !important;
   z-index: 400 !important;
   padding: 0 !important;
   margin: 0 !important;
   background: transparent !important;
}

/* 隐藏 TabsToolbar 里可能残留的原生按钮容器，避免重影 */
toolbar#TabsToolbar .titlebar-buttonbox-container:not(:first-of-type) {
   display: none !important;
}

/* 统一按钮间距（使用 margin 避免 gap 在某些构建中失效） */
#navigator-toolbox .titlebar-buttonbox .titlebar-button { margin-left: var(--wc-gap) !important; }
#navigator-toolbox .titlebar-buttonbox .titlebar-button:first-child { margin-left: 0 !important; }

/* 避免按钮被拖拽区域误判为可拖拽，保持点击优先 */
#navigator-toolbox .titlebar-buttonbox .titlebar-button { -moz-window-dragging: no-drag; }

/* 如果看到仍有一层系统原生按钮描边，可尝试隐藏备用容器（视版本可能不存在） */
#TabsToolbar .titlebar-buttonbox-container[hidden] { display: none !important; }

/* 窗口最大化时微调顶部距离（Windows 最大化时顶部像素紧贴） */
#main-window[sizemode="maximized"] #navigator-toolbox .titlebar-buttonbox-container {
   top: calc(var(--wc-top-offset) - 2px) !important;
}

/* 适配窄宽窗口：自动减间距 */
@media (max-width: 900px) {
   :root { --wc-gap: 6px; --wc-cluster-width: calc(var(--wc-height) * 3 + var(--wc-gap) * 2 + 12px); }
}
